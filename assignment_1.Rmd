---
title: "Assignment 1"
author: "Songnan QUAN"
date: "2018/9/24"
output: html_document
---


## Exercise 1: Working with RMarkdown files
R is a free software environment for statistical computing and graphics.


## Exercice 2: Starting R programming
```{r}
possible_outcomes <- c(0, 1, 2, 3, 4, 5)
outcome_probabilities <- c(0.1, 0.5, 0.2, 0.1, 0.05, 0.05)
n_data_points <- 400
set.seed(1)
fake_data_points <- sample(possible_outcomes,
                           n_data_points,
                           replace=T,
                           prob=outcome_probabilities)
set.seed(NULL)
fake_data_set <- tibble::data_frame(`Fake measurement`=fake_data_points)
```

```{r}
ggplot2::ggplot(fake_data_set, ggplot2::aes(x=`Fake measurement`)) + ggplot2::geom_histogram(bins=5, colour="black", fill="lightgrey")
```

Statement 1. pass
  
Statement 2. this assignment is exactely like the first line, which creates a vector of numbers (floats) called "outcome_probabilities". I think it contains all the probabilities for each possible outcome in the first line, because it's called "outcome_probabilities", its length is exactly like the first vector, these numbers are between 0 and 1, and their sum equals 1.

Statement 3. this line creates a new varaible "n_data_points" and sets its value as 400. Maybe this variable is for 400 distributions of the possible outcomes.

Statement 4. this statement 

Statement 5

Statement 6


## Exercice 3: More R programming

### Sub-exercise 3-a

Load contents of the file "functions.R"
```{r}
source("functions.R")
```

Test the function "sum_column(d, var)"
```{r}
print(sum_column(iris, "Sepal.Length"))
print(sum_column(iris, "Species"))
print(sum_column(warpbreaks, "breaks"))
```

### Sub-exercise 3-b
Test the function "my_sum(x)"
```{r}
print(my_sum(iris$Sepal.Length))
print(my_sum(iris$Species))
print(my_sum(warpbreaks$breaks))
```

### Sub-exercise 3-c
Test the function "sum_diveded_by(x, k)"
```{r}
print(sum_divided_by(iris$Sepal.Length, 12))
print(sum_divided_by(iris$Species, 22))
print(sum_divided_by(iris$Sepal.Length, "Not numeric"))
print(sum_divided_by(warpbreaks$breaks, -12))
```

### Sub-exercise 3-d
Test the function "my_mean(x)"
```{r}
print(my_mean(iris$Sepal.Length))
print(my_mean(iris$Species))
print(my_mean(warpbreaks$breaks))
```


## Exercice 4

### Sub-exercise 4-a
```{r}
print(grouped_violin_plot(iris, "Sepal.Length", "Species"))
```

### Sub-exercise 4-b
```{r}
p <- grouped_violin_plot(iris, "Sepal.Length", "Species")
# YOUR CODE HERE: Change the colour scheme for the interior of the three violin plots
#                 to anything else at all.
p <- p + ggplot2::scale_fill_manual(values=c("yellow","blue","brown"))
# YOUR CODE HERE: Add a main title that says "Iris data".
p <- p + ggplot2::labs(title="Iris data")

print(p)
```


## Exercice 5

### Sub-exercise 5-a
```{r}
difference_in_medians(iris, "Sepal.Width", "Species", "versicolor", "virginica")
difference_in_medians(iris, "Sepal.Width", "Species", "virginica", "virginica")
```

### Sub-exercise 5-b
```{r}
iris$Sepal.Width[1:10]
if(!exists(".Random.seed")) set.seed(NULL)
previous_seed <- .Random.seed
set.seed(1)
randomize(iris, "Sepal.Width")$Sepal.Width[1:10]
randomize(iris, "Species")$Species[1:10]
randomize(iris, "Species")$Sepal.Width[1:10]
set.seed(previous_seed)
```

### Sub-exercise 5-c
```{r}
if(!exists(".Random.seed")) set.seed(NULL)
previous_seed <- .Random.seed
set.seed(1)
ptest_1 <- permutation_twogroups(iris, "Sepal.Width", "Species", "versicolor","virginica", difference_in_medians, n_samples=10)
ptest_2 <- permutation_twogroups(iris, "Sepal.Width", "Species", "versicolor","virginica", difference_in_medians, n_samples=10)
ptest_3 <- permutation_twogroups(randomize(iris, "Sepal.Width"), "Sepal.Width","Species", "versicolor", "virginica",difference_in_medians, n_samples=10)
set.seed(previous_seed)
print(ptest_1)
print(ptest_2)
print(ptest_3)
print(ptest_3$observed)
print(ptest_3[["observed"]])

```

### Sub-exercise 5-d
### Sub-exercise 5-e

```{r}
if(!exists(".Random.seed")) set.seed(NULL)
previous_seed <- .Random.seed
set.seed(1)
ptest <- permutation_twogroups(iris, "Sepal.Width", "Species", "versicolor","virginica", difference_in_medians)
set.seed(previous_seed)
```

```{r}
ptest_d <- tibble::as_tibble(ptest["permuted"])
# YOUR CODE HERE: plot a histogram with a vertical line at the observed value

```

